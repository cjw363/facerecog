webpackJsonp([2,8,13,22],{"5qkj":function(e,t){},"9oQm":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("yyct"),s={name:"DeviceInfo",inject:["reloadDevice"],props:{device:{type:Object,default:function(){return{}},device_sn:"",device_id:"",online:"",arcface_appid:"",register_time:"",activate_time:"",last_online_time:"",last_offline_time:"",sync_success:"",sync_fail:"",without_sync:"",app_version:""}},methods:{checkUpdate:function(){this.$post("/device/check_update",{device_sn:this.device.device_sn}).then(function(e){105===e.code?i.a.info(e.message):i.a.info("未发现新版本")})},deleteDevice:function(){var e=this;i.a.confirm("注意: 删除设备会删除该设备信息以及相关权限数据,确定要删除该设备吗").then(function(){e.$post("/device/delete",{device_id:e.device.device_id}).then(function(t){i.a.info(t.message),e.reloadDevice(),e.$router.push("/device/device_tbl")})})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{"label-width":"130px"}},[a("el-form-item",{attrs:{label:"设备sn编号"}},[a("span",[e._v(e._s(e.device.device_sn))])]),e._v(" "),a("el-form-item",{attrs:{label:"在线状态"}},[1===e.device.online?a("span",[e._v("在线")]):e._e(),e._v(" "),0===e.device.online?a("span",[e._v("离线")]):e._e()]),e._v(" "),a("el-form-item",{attrs:{label:"授权码"}},[a("span",[e._v(e._s(e.device.arcface_appid))])]),e._v(" "),a("el-form-item",{attrs:{label:"注册时间"}},[a("span",[e._v(e._s(e._f("formatDate")(e.device.register_time)))])]),e._v(" "),a("el-form-item",{attrs:{label:"激活时间"}},[a("span",[e._v(e._s(e._f("formatDate")(e.device.activate_time)))])]),e._v(" "),a("el-form-item",{attrs:{label:"最后一次上线时间"}},[a("span",[e._v(e._s(e._f("formatDate")(e.device.last_online_time)))])]),e._v(" "),a("el-form-item",{attrs:{label:"最后一次下线时间"}},[a("span",[e._v(e._s(e._f("formatDate")(e.device.last_offline_time)))])]),e._v(" "),a("el-form-item",{attrs:{label:"同步成功"}},[a("span",[e._v(e._s(e.device.sync_success))])]),e._v(" "),a("el-form-item",{attrs:{label:"同步失败"}},[a("span",[e._v(e._s(e.device.sync_fail))])]),e._v(" "),a("el-form-item",{attrs:{label:"未同步"}},[a("span",[e._v(e._s(e.device.without_sync))])]),e._v(" "),a("el-form-item",{attrs:{label:"当前app版本"}},[a("span",[e._v(e._s(e.device.app_version))]),e._v(" "),a("el-button",{attrs:{size:"small",type:"success"},on:{click:e.checkUpdate}},[e._v("更新")])],1),e._v(" "),a("el-form-item",{attrs:{label:"操作"}},[a("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.deleteDevice}},[e._v("删除")])],1)],1)},staticRenderFns:[]};var l=a("VU/8")(s,n,!1,function(e){a("5qkj")},"data-v-d0af72e0",null);t.default=l.exports},KgPE:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("CxlR"),s=a("ofK9"),n=a("yyct"),l={name:"DeviceGrantPerson",components:{DialogAddPerson:i.default,DialogChangeGrant:s.default},props:{device:{device_sn:"",device_id:"",group_list:""}},data:function(){return{tableData1:[],currentPage1:1,pageSizes1:[5,10,20],pageSize1:10,tableTotal:0,keyword:"",selectGroupModel:"",group_id:""}},methods:{get:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pageNum:this.currentPage1,pageSize:this.pageSize1,device_sn:this.device.device_sn,group_id:this.group_id,keyword:this.keyword};this.$get("/device/grant_person_list",t).then(function(t){e.tableData1=t.data.list,e.tableTotal=t.data.total})},handleChange1:function(){this.get()},changeSelectGroup:function(e){this.group_id=e,this.get({group_id:e,pageNum:1,pageSize:this.pageSize1,device_sn:this.device.device_sn,keyword:this.keyword})},selectGrantPersonList:function(){this.get({pageNum:1,group_id:this.group_id,pageSize:this.pageSize1,device_sn:this.device.device_sn,keyword:this.keyword})},openDialogAddPerson:function(){this.$refs.refDialogAddPerson.openDialogAddPerson()},openDialogChangeGrant:function(e){this.$refs.refDialogChangeGrant.initData(e),this.$refs.refDialogChangeGrant.changeDialogGrantPersonVs()},banGrantPerson:function(e){var t=this;this.$post("/grant/ban",{device_ids:this.device.device_id,person_ids:e.row.person_id}).then(function(a){n.a.success(a.message),t.$utils.arrayRemoveObj(t.tableData1,e.row),t.tableTotal--})},changeTableData:function(e){this.tableData1.find(function(t){e.grant_id===t.grant_id&&(t.pass_number=e.pass_number,t.pass_start_time=e.pass_start_time,t.pass_end_time=e.pass_end_time)})}},created:function(){this.group_id="",this.selectGroupModel="",this.keyword="",this.get()},watch:{device:function(){this.group_id="",this.selectGroupModel="",this.keyword="",this.get()}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("el-form",[a("el-form-item",[a("el-row",[a("div",{staticStyle:{float:"left"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择部门",size:"small"},on:{change:e.changeSelectGroup},model:{value:e.selectGroupModel,callback:function(t){e.selectGroupModel=t},expression:"selectGroupModel"}},e._l(e.device.group_list,function(e){return a("el-option",{key:e.group_id,attrs:{label:e.group_name,value:e.group_id}})}),1),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:e.openDialogAddPerson}},[e._v("添加")])],1),e._v(" "),a("div",{staticStyle:{float:"right"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"请输入搜索内容"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.selectGrantPersonList}},[e._v("搜索")])],1)])],1)],1),e._v(" "),[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData1,stripe:""}},[a("el-table-column",{attrs:{prop:"grant_id",label:"授权ID","min-width":"10%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"person_name",label:"姓名","min-width":"10%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"emp_number",label:"工号","min-width":"10%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sync_status",label:"同步状态","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.sync_status?a("span",[e._v("未同步")]):1===t.row.sync_status?a("span",[e._v("同步成功")]):2===t.row.sync_status?a("span",[e._v("下载失败")]):3===t.row.sync_status?a("span",[e._v("图片失败")]):4===t.row.sync_status?a("span",[e._v("特征值失败")]):a("span",[e._v("其他失败")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"pass_number",label:"通行次数","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[9999999999===t.row.pass_number?a("span",[e._v("无限次数")]):a("span",[e._v(e._s(t.row.pass_number))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"pass_start_time",label:"通行时段","min-width":"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.pass_start_time.indexOf("2286")||0===t.row.pass_end_time.indexOf("2286")?a("span",[e._v("无限时段")]):e._e(),e._v(" "),0!==t.row.pass_start_time.indexOf("2286")?a("span",[e._v(e._s(e._f("formatDate")(t.row.pass_start_time))+" - "+e._s(e._f("formatDate")(t.row.pass_end_time)))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"20%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){return e.openDialogChangeGrant(t.row)}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.banGrantPerson(t)}}},[e._v("禁止")])]}}])})],1)],e._v(" "),[a("div",{staticClass:"block"},[a("el-pagination",{ref:"pagination1",attrs:{"current-page":e.currentPage1,"page-size":e.pageSize1,"page-sizes":e.pageSizes1,"prev-text":"上一页","next-text":"下一页",layout:"total, sizes, prev, pager, next, jumper",total:e.tableTotal},on:{"size-change":e.handleChange1,"current-change":e.handleChange1,"update:currentPage":function(t){e.currentPage1=t},"update:current-page":function(t){e.currentPage1=t},"update:pageSize":function(t){e.pageSize1=t},"update:page-size":function(t){e.pageSize1=t}}})],1)],e._v(" "),a("DialogAddPerson",{ref:"refDialogAddPerson",attrs:{device:e.device}}),e._v(" "),a("DialogChangeGrant",{ref:"refDialogChangeGrant",attrs:{device:e.device}})],2)},staticRenderFns:[]};var c=a("VU/8")(l,o,!1,function(e){a("qOp1")},"data-v-393e0b80",null);t.default=c.exports},NfOI:function(e,t){},St3J:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("woOf"),s=a.n(i),n=a("yyct"),l={name:"DeviceConfig",props:{device:{device_sn:"",device_name:"",open_door_type:"",success_msg:"",fail_msg:""}},data:function(){return{options1:[{value:0,label:"人脸"},{value:1,label:"身份证"},{value:2,label:"工号"},{value:3,label:"人脸+身份证"},{value:4,label:"人脸+工号"}],deviceModel:""}},methods:{changeDeviceInfo:function(){var e=this;this.$post("/device/change_info",{device_sn:this.deviceModel.device_sn,device_name:this.deviceModel.device_name,open_door_type:this.deviceModel.open_door_type,success_msg:this.deviceModel.success_msg,fail_msg:this.deviceModel.fail_msg}).then(function(t){n.a.success(t.message),e.deviceList.find(function(t){return t.device_sn===e.device.device_sn}).device_name=e.deviceModel.device_name})},restoreDeviceInfo:function(){this.deviceModel=s()({},this.device)}},watch:{device:function(e,t){this.deviceModel=s()({},this.device)}},computed:{deviceList:function(){return this.$store.getters["device/getDeviceList"]}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{"label-width":"100px"},model:{value:e.deviceModel,callback:function(t){e.deviceModel=t},expression:"deviceModel"}},[a("el-form-item",{attrs:{label:"设备名称"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",size:"small"},model:{value:e.deviceModel.device_name,callback:function(t){e.$set(e.deviceModel,"device_name",t)},expression:"deviceModel.device_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"开门条件"}},[a("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:e.deviceModel.open_door_type,callback:function(t){e.$set(e.deviceModel,"open_door_type",t)},expression:"deviceModel.open_door_type"}},e._l(e.options1,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"成功文本"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",size:"small"},model:{value:e.deviceModel.success_msg,callback:function(t){e.$set(e.deviceModel,"success_msg",t)},expression:"deviceModel.success_msg"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"失败文本"}},[a("el-input",{attrs:{type:"text",autocomplete:"off",size:"small"},model:{value:e.deviceModel.fail_msg,callback:function(t){e.$set(e.deviceModel,"fail_msg",t)},expression:"deviceModel.fail_msg"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{size:"small",type:"success"},on:{click:e.changeDeviceInfo}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.restoreDeviceInfo}},[e._v("取消")])],1)],1)},staticRenderFns:[]};var c=a("VU/8")(l,o,!1,function(e){a("T186")},"data-v-7f16f6ef",null);t.default=c.exports},T186:function(e,t){},f2NI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("9oQm"),s=a("St3J"),n=a("KgPE"),l={name:"DeviceDetail",data:function(){return{activeName:"first",device:{}}},components:{DeviceInfo:i.default,DeviceConfig:s.default,DeviceGrantPerson:n.default},methods:{get:function(){var e=this;this.$post("/device/detail",{device_sn:this.$route.query.device_sn}).then(function(t){e.device=t.data})}},created:function(){this.get()},watch:{$route:"get"}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[e._v("设备管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("设备详情")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(e.device.device_name))])],1),e._v(" "),[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[a("DeviceInfo",{attrs:{device:e.device}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"功能配置",name:"second"}},[a("DeviceConfig",{attrs:{device:e.device}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"已授权人员",name:"third"}},[a("DeviceGrantPerson",{attrs:{device:e.device}})],1)],1)]],2)},staticRenderFns:[]};var c=a("VU/8")(l,o,!1,function(e){a("NfOI")},"data-v-0b34a7d8",null);t.default=c.exports},qOp1:function(e,t){}});